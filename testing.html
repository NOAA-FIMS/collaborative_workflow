<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Testing | FIMS Developer Handbook</title>
  <meta name="description" content="This is a handbook for FIMS developers and contributors." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Testing | FIMS Developer Handbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a handbook for FIMS developers and contributors." />
  <meta name="github-repo" content="noaa-fims/collaborative_workflow" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Testing | FIMS Developer Handbook" />
  
  <meta name="twitter:description" content="This is a handbook for FIMS developers and contributors." />
  

<meta name="author" content="FIMS Implementation Team" />


<meta name="date" content="2025-03-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon" />
<link rel="prev" href="documentation-template.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="extra.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">FIMS Developer Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Contributing to this book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.1</b> Description</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#edit-and-preview-book-changes"><i class="fa fa-check"></i><b>1.2</b> Edit and preview book changes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="code-of-conduct.html"><a href="code-of-conduct.html"><i class="fa fa-check"></i><b>2</b> Code of conduct</a>
<ul>
<li class="chapter" data-level="2.1" data-path="code-of-conduct.html"><a href="code-of-conduct.html#fims-contributor-conduct"><i class="fa fa-check"></i><b>2.1</b> FIMS contributor conduct</a></li>
<li class="chapter" data-level="2.2" data-path="code-of-conduct.html"><a href="code-of-conduct.html#our-pledge"><i class="fa fa-check"></i><b>2.2</b> Our pledge</a></li>
<li class="chapter" data-level="2.3" data-path="code-of-conduct.html"><a href="code-of-conduct.html#our-standards"><i class="fa fa-check"></i><b>2.3</b> Our standards</a></li>
<li class="chapter" data-level="2.4" data-path="code-of-conduct.html"><a href="code-of-conduct.html#enforcement-responsibilities"><i class="fa fa-check"></i><b>2.4</b> Enforcement responsibilities</a></li>
<li class="chapter" data-level="2.5" data-path="code-of-conduct.html"><a href="code-of-conduct.html#scope"><i class="fa fa-check"></i><b>2.5</b> Scope</a></li>
<li class="chapter" data-level="2.6" data-path="code-of-conduct.html"><a href="code-of-conduct.html#enforcement"><i class="fa fa-check"></i><b>2.6</b> Enforcement</a></li>
<li class="chapter" data-level="2.7" data-path="code-of-conduct.html"><a href="code-of-conduct.html#enforcement-guidelines"><i class="fa fa-check"></i><b>2.7</b> Enforcement guidelines</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="code-of-conduct.html"><a href="code-of-conduct.html#correction"><i class="fa fa-check"></i><b>2.7.1</b> 1. Correction</a></li>
<li class="chapter" data-level="2.7.2" data-path="code-of-conduct.html"><a href="code-of-conduct.html#warning"><i class="fa fa-check"></i><b>2.7.2</b> 2. Warning</a></li>
<li class="chapter" data-level="2.7.3" data-path="code-of-conduct.html"><a href="code-of-conduct.html#temporary-ban"><i class="fa fa-check"></i><b>2.7.3</b> 3. Temporary ban</a></li>
<li class="chapter" data-level="2.7.4" data-path="code-of-conduct.html"><a href="code-of-conduct.html#permanent-ban"><i class="fa fa-check"></i><b>2.7.4</b> 4. Permanent ban</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="code-of-conduct.html"><a href="code-of-conduct.html#supporting-good-conduct"><i class="fa fa-check"></i><b>2.8</b> Supporting good conduct</a></li>
<li class="chapter" data-level="2.9" data-path="code-of-conduct.html"><a href="code-of-conduct.html#attribution"><i class="fa fa-check"></i><b>2.9</b> Attribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html"><i class="fa fa-check"></i><b>3</b> FIMS project management process</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#fims-governance"><i class="fa fa-check"></i><b>3.1</b> FIMS governance</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#developers"><i class="fa fa-check"></i><b>3.1.1</b> Developers</a></li>
<li class="chapter" data-level="3.1.2" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#c-developers"><i class="fa fa-check"></i><b>3.1.2</b> C++ developers</a></li>
<li class="chapter" data-level="3.1.3" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#r-developers"><i class="fa fa-check"></i><b>3.1.3</b> R developers</a></li>
<li class="chapter" data-level="3.1.4" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#all-developers"><i class="fa fa-check"></i><b>3.1.4</b> All developers</a></li>
<li class="chapter" data-level="3.1.5" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#project-lead"><i class="fa fa-check"></i><b>3.1.5</b> Project Lead</a></li>
<li class="chapter" data-level="3.1.6" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#lead-software-architect"><i class="fa fa-check"></i><b>3.1.6</b> Lead Software Architect</a></li>
<li class="chapter" data-level="3.1.7" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#lead-test-engineer"><i class="fa fa-check"></i><b>3.1.7</b> Lead Test Engineer</a></li>
<li class="chapter" data-level="3.1.8" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#lead-statistical-computing-engineer"><i class="fa fa-check"></i><b>3.1.8</b> Lead Statistical Computing Engineer</a></li>
<li class="chapter" data-level="3.1.9" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#outreach-and-transition-coordinator"><i class="fa fa-check"></i><b>3.1.9</b> Outreach and Transition Coordinator</a></li>
<li class="chapter" data-level="3.1.10" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#lead-of-workflows-accessibility-and-integration"><i class="fa fa-check"></i><b>3.1.10</b> Lead of Workflows, Accessibility, and Integration</a></li>
<li class="chapter" data-level="3.1.11" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#regional-representatives"><i class="fa fa-check"></i><b>3.1.11</b> Regional representatives</a></li>
<li class="chapter" data-level="3.1.12" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#code-of-conduct-enforcement"><i class="fa fa-check"></i><b>3.1.12</b> Code of conduct enforcement</a></li>
<li class="chapter" data-level="3.1.13" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#external-collaborators"><i class="fa fa-check"></i><b>3.1.13</b> External collaborators</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#fims-development-cycle"><i class="fa fa-check"></i><b>3.2</b> FIMS development cycle</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#issue-lifecycle"><i class="fa fa-check"></i><b>3.2.1</b> Issue lifecycle</a></li>
<li class="chapter" data-level="3.2.2" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#m2-development-workflow"><i class="fa fa-check"></i><b>3.2.2</b> M2 development workflow</a></li>
<li class="chapter" data-level="3.2.3" data-path="fims-project-management-process.html"><a href="fims-project-management-process.html#feature-validation"><i class="fa fa-check"></i><b>3.2.3</b> Feature validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="m1-model-specification.html"><a href="m1-model-specification.html"><i class="fa fa-check"></i><b>4</b> M1 model specification</a>
<ul>
<li class="chapter" data-level="4.1" data-path="m1-model-specification.html"><a href="m1-model-specification.html#inherited-functors-from-tmb"><i class="fa fa-check"></i><b>4.1</b> Inherited functors from <code>TMB</code></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="m1-model-specification.html"><a href="m1-model-specification.html#atomic-functions"><i class="fa fa-check"></i><b>4.1.1</b> Atomic functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="m1-model-specification.html"><a href="m1-model-specification.html#statistical-distributions"><i class="fa fa-check"></i><b>4.1.2</b> Statistical distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="m1-model-specification.html"><a href="m1-model-specification.html#beverton-holt-recruitment-function"><i class="fa fa-check"></i><b>4.2</b> Beverton-Holt recruitment function</a></li>
<li class="chapter" data-level="4.3" data-path="m1-model-specification.html"><a href="m1-model-specification.html#logistic-function-with-extensions"><i class="fa fa-check"></i><b>4.3</b> Logistic function with extensions</a></li>
<li class="chapter" data-level="4.4" data-path="m1-model-specification.html"><a href="m1-model-specification.html#catch-and-fishing-mortality"><i class="fa fa-check"></i><b>4.4</b> Catch and fishing mortality</a></li>
<li class="chapter" data-level="4.5" data-path="m1-model-specification.html"><a href="m1-model-specification.html#modeling-loops"><i class="fa fa-check"></i><b>4.5</b> Modeling loops</a></li>
<li class="chapter" data-level="4.6" data-path="m1-model-specification.html"><a href="m1-model-specification.html#expected-numbers-and-quantities"><i class="fa fa-check"></i><b>4.6</b> Expected numbers and quantities</a></li>
<li class="chapter" data-level="4.7" data-path="m1-model-specification.html"><a href="m1-model-specification.html#initial-values"><i class="fa fa-check"></i><b>4.7</b> Initial values</a></li>
<li class="chapter" data-level="4.8" data-path="m1-model-specification.html"><a href="m1-model-specification.html#likelihood-calculations"><i class="fa fa-check"></i><b>4.8</b> Likelihood calculations</a></li>
<li class="chapter" data-level="4.9" data-path="m1-model-specification.html"><a href="m1-model-specification.html#statistical-inference"><i class="fa fa-check"></i><b>4.9</b> Statistical Inference:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="user-guide.html"><a href="user-guide.html"><i class="fa fa-check"></i><b>5</b> User guide</a>
<ul>
<li class="chapter" data-level="5.1" data-path="user-guide.html"><a href="user-guide.html#installing-the-package-from-r-universe"><i class="fa fa-check"></i><b>5.1</b> Installing the package from R universe</a></li>
<li class="chapter" data-level="5.2" data-path="user-guide.html"><a href="user-guide.html#running-fims"><i class="fa fa-check"></i><b>5.2</b> Running FIMS</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html"><i class="fa fa-check"></i><b>6</b> Developer Software and Installation Guide</a>
<ul>
<li class="chapter" data-level="6.1" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#codespaces-as-an-alternative-to-installing-software"><i class="fa fa-check"></i><b>6.1</b> Codespaces as an alternative to installing software</a></li>
<li class="chapter" data-level="6.2" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#software-to-install"><i class="fa fa-check"></i><b>6.2</b> Software to install</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#git"><i class="fa fa-check"></i><b>6.2.1</b> git</a></li>
<li class="chapter" data-level="6.2.2" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#development-environment"><i class="fa fa-check"></i><b>6.2.2</b> Development environment</a></li>
<li class="chapter" data-level="6.2.3" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#c-compiler"><i class="fa fa-check"></i><b>6.2.3</b> C++ compiler</a></li>
<li class="chapter" data-level="6.2.4" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#googletest"><i class="fa fa-check"></i><b>6.2.4</b> GoogleTest</a></li>
<li class="chapter" data-level="6.2.5" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#gdb-debugger"><i class="fa fa-check"></i><b>6.2.5</b> GDB debugger</a></li>
<li class="chapter" data-level="6.2.6" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#doxygen"><i class="fa fa-check"></i><b>6.2.6</b> Doxygen</a></li>
<li class="chapter" data-level="6.2.7" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#r"><i class="fa fa-check"></i><b>6.2.7</b> R</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#installing-fims"><i class="fa fa-check"></i><b>6.3</b> Installing FIMS</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#clone-and-build"><i class="fa fa-check"></i><b>6.3.1</b> Clone and build</a></li>
<li class="chapter" data-level="6.3.2" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#precompiled"><i class="fa fa-check"></i><b>6.3.2</b> Precompiled</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="developer-software-and-installation-guide.html"><a href="developer-software-and-installation-guide.html#getting-help"><i class="fa fa-check"></i><b>6.4</b> Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html"><i class="fa fa-check"></i><b>7</b> Contributor Guidelines</a>
<ul>
<li class="chapter" data-level="7.1" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#code"><i class="fa fa-check"></i><b>7.1</b> Code</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#style-guide"><i class="fa fa-check"></i><b>7.1.1</b> Style Guide</a></li>
<li class="chapter" data-level="7.1.2" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#coding-good-practices"><i class="fa fa-check"></i><b>7.1.2</b> Coding Good Practices</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#github-collaborative-environment"><i class="fa fa-check"></i><b>7.2</b> GitHub Collaborative Environment</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#github-issues"><i class="fa fa-check"></i><b>7.2.1</b> GitHub Issues</a></li>
<li class="chapter" data-level="7.2.2" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#github-cloning"><i class="fa fa-check"></i><b>7.2.2</b> GitHub Cloning</a></li>
<li class="chapter" data-level="7.2.3" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#github-branching"><i class="fa fa-check"></i><b>7.2.3</b> GitHub Branching</a></li>
<li class="chapter" data-level="7.2.4" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#github-pull-requests"><i class="fa fa-check"></i><b>7.2.4</b> GitHub Pull Requests</a></li>
<li class="chapter" data-level="7.2.5" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#github-actions"><i class="fa fa-check"></i><b>7.2.5</b> GitHub Actions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#git-1"><i class="fa fa-check"></i><b>7.3</b> git</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="contributor-guidelines.html"><a href="contributor-guidelines.html#git-example"><i class="fa fa-check"></i><b>7.3.1</b> git Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hpp-template-for-c-modules.html"><a href="hpp-template-for-c-modules.html"><i class="fa fa-check"></i><b>8</b> .hpp template for C++ modules</a></li>
<li class="chapter" data-level="9" data-path="documentation-template.html"><a href="documentation-template.html"><i class="fa fa-check"></i><b>9</b> Documentation Template</a>
<ul>
<li class="chapter" data-level="9.1" data-path="documentation-template.html"><a href="documentation-template.html#writing-function-reference"><i class="fa fa-check"></i><b>9.1</b> Writing function reference</a></li>
<li class="chapter" data-level="9.2" data-path="documentation-template.html"><a href="documentation-template.html#writing-a-vignette"><i class="fa fa-check"></i><b>9.2</b> Writing a vignette</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>10</b> Testing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="testing.html"><a href="testing.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="testing.html"><a href="testing.html#c-unit-testing-and-benchmarking"><i class="fa fa-check"></i><b>10.2</b> C++ unit testing and benchmarking</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="testing.html"><a href="testing.html#build-and-run-the-tests"><i class="fa fa-check"></i><b>10.2.1</b> Build and run the tests</a></li>
<li class="chapter" data-level="10.2.2" data-path="testing.html"><a href="testing.html#adding-a-c-test"><i class="fa fa-check"></i><b>10.2.2</b> Adding a C++ test</a></li>
<li class="chapter" data-level="10.2.3" data-path="testing.html"><a href="testing.html#debugging-a-c-test"><i class="fa fa-check"></i><b>10.2.3</b> Debugging a C++ test</a></li>
<li class="chapter" data-level="10.2.4" data-path="testing.html"><a href="testing.html#benchmark-example"><i class="fa fa-check"></i><b>10.2.4</b> Benchmark example</a></li>
<li class="chapter" data-level="10.2.5" data-path="testing.html"><a href="testing.html#clean-up-after-running-c-tests"><i class="fa fa-check"></i><b>10.2.5</b> Clean up after running C++ tests</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="testing.html"><a href="testing.html#templates-for-googletest-testing"><i class="fa fa-check"></i><b>10.3</b> Templates for GoogleTest testing</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="testing.html"><a href="testing.html#c-test-templates"><i class="fa fa-check"></i><b>10.3.1</b> C++ test templates</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="testing.html"><a href="testing.html#r-testing"><i class="fa fa-check"></i><b>10.4</b> R testing</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="testing.html"><a href="testing.html#testing-fims-locally"><i class="fa fa-check"></i><b>10.4.1</b> Testing FIMS locally</a></li>
<li class="chapter" data-level="10.4.2" data-path="testing.html"><a href="testing.html#testing-using-gdbsource"><i class="fa fa-check"></i><b>10.4.2</b> Testing using <code>gdbsource</code></a></li>
<li class="chapter" data-level="10.4.3" data-path="testing.html"><a href="testing.html#and-file-organization"><i class="fa fa-check"></i><b>10.4.3</b> and file organization</a></li>
<li class="chapter" data-level="10.4.4" data-path="testing.html"><a href="testing.html#r-template"><i class="fa fa-check"></i><b>10.4.4</b> R template</a></li>
<li class="chapter" data-level="10.4.5" data-path="testing.html"><a href="testing.html#random-numbers"><i class="fa fa-check"></i><b>10.4.5</b> Random numbers</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://noaa-fims.github.io/collaborative_workflow" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FIMS Developer Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="testing" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Testing<a href="testing.html#testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Introduction<a href="testing.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our testing framework includes several types of tests. Unit and functional tests are created for individual functions and modules, respectively, where unit tests test each of the smallest components and functional tests ensure that the application of small components function within the requirements. Integration tests verify that modules work well together. Run-time tests include checks that are integrated into the code to catch errors related to user input. Regression testing and platform compatibility testing are executed before pre-releasing FIMS to ensure that previously tested pieces are still performing after the code has been changed on all platforms of interest. Beta-testing is used to gather feedback from users (i.e., members of FIMS Implementation Team and other users) during the pre-release stage. Finally, one-off testing is used for replicating and fixing user-reported bugs. Some of these one-off tests may eventually be integrated into the permanent testing framework. Or, if while you are coding you find a useful interactive tests that helped you build something, then it should be converted into {testthat} or GoogleTest tests.</p>
<p>FIMS uses GoogleTest to build a C++ unit testing framework and {testthat} to build an R testing framework. FIMS uses Google Benchmark to measure the real time and CPU time used for running the produced binaries. All required software for testing can be installed using the instructions in the <a href="developer-software-and-installation-guide.html#software-to-install">Software to install section</a>.</p>
</div>
<div id="c-unit-testing-and-benchmarking" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> C++ unit testing and benchmarking<a href="testing.html#c-unit-testing-and-benchmarking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Inside of your cloned version of FIMS, the file <code>CMakeLists.txt</code>, in the top-level directory, instructs <code>Cmake</code> on how to create the build files, including setting up Google Test. The Google Test code is in <code>tests/gtest</code>. Within this subdirectory is another <code>CMakeLists.txt</code> that contains additional specifications on how to register the individual tests.</p>
<div id="build-and-run-the-tests" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Build and run the tests<a href="testing.html#build-and-run-the-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following commands on the command line (note that Windows users cannot use Git bash and must use a native Windows shell) execute the outlined steps and are needed to build the tests:</p>
<ol style="list-style-type: decimal">
<li>Generate the build system using <code>Ninja</code> as the generator, which creates the <code>build</code> directory.</li>
<li>Use <code>Cmake</code> to build in the <code>build</code> directory in parallel using 16 jobs but <code>--parallel 16</code> can be deleted.</li>
<li>Run the tests using <code>ctest</code> in parallel using 16 jobs but <code>--parallel 16</code> can be deleted.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="testing.html#cb17-1" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-S</span> . <span class="at">-B</span> build <span class="at">-G</span> Ninja </span>
<span id="cb17-2"><a href="testing.html#cb17-2" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build <span class="at">--parallel</span> 16</span>
<span id="cb17-3"><a href="testing.html#cb17-3" tabindex="-1"></a><span class="ex">ctest</span> <span class="at">--test-dir</span> build <span class="at">--parallel</span> 16</span></code></pre></div>
<p>The output from running the tests should look something like the following:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="testing.html#cb18-1" tabindex="-1"></a><span class="ex">Internal</span> ctest changing into directory: C:/github_repos/NOAA-FIMS_org/FIMS/build</span>
<span id="cb18-2"><a href="testing.html#cb18-2" tabindex="-1"></a><span class="ex">Test</span> project C:/github_repos/NOAA-FIMS_org/FIMS/build</span>
<span id="cb18-3"><a href="testing.html#cb18-3" tabindex="-1"></a>    <span class="ex">Start</span> 1: dlognorm.use_double_inputs</span>
<span id="cb18-4"><a href="testing.html#cb18-4" tabindex="-1"></a><span class="ex">1/5</span> Test <span class="co">#1: dlognorm.use_double_inputs .......   Passed    0.04 sec</span></span>
<span id="cb18-5"><a href="testing.html#cb18-5" tabindex="-1"></a>    <span class="ex">Start</span> 2: dlognorm.use_int_inputs</span>
<span id="cb18-6"><a href="testing.html#cb18-6" tabindex="-1"></a><span class="ex">2/5</span> Test <span class="co">#2: dlognorm.use_int_inputs ..........   Passed    0.04 sec</span></span>
<span id="cb18-7"><a href="testing.html#cb18-7" tabindex="-1"></a>    <span class="ex">Start</span> 3: modelTest.eta</span>
<span id="cb18-8"><a href="testing.html#cb18-8" tabindex="-1"></a><span class="ex">3/5</span> Test <span class="co">#3: modelTest.eta ....................   Passed    0.04 sec</span></span>
<span id="cb18-9"><a href="testing.html#cb18-9" tabindex="-1"></a>    <span class="ex">Start</span> 4: modelTest.nll</span>
<span id="cb18-10"><a href="testing.html#cb18-10" tabindex="-1"></a><span class="ex">4/5</span> Test <span class="co">#4: modelTest.nll ....................   Passed    0.04 sec</span></span>
<span id="cb18-11"><a href="testing.html#cb18-11" tabindex="-1"></a>    <span class="ex">Start</span> 5: modelTest.evaluate</span>
<span id="cb18-12"><a href="testing.html#cb18-12" tabindex="-1"></a><span class="ex">5/5</span> Test <span class="co">#5: modelTest.evaluate ...............   Passed    0.04 sec</span></span>
<span id="cb18-13"><a href="testing.html#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="testing.html#cb18-14" tabindex="-1"></a><span class="ex">100%</span> tests passed, 0 tests failed out of 5</span></code></pre></div>
</div>
<div id="adding-a-c-test" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Adding a C++ test<a href="testing.html#adding-a-c-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a file dlognorm.hpp within the <code>src</code> subfolder that contains a simple function:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb19-1"><a href="testing.html#cb19-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb19-2"><a href="testing.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="testing.html#cb19-3" tabindex="-1"></a>template<span class="op">&lt;</span>class Type<span class="op">&gt;</span></span>
<span id="cb19-4"><a href="testing.html#cb19-4" tabindex="-1"></a>Type dlognorm<span class="op">(</span>Type x<span class="op">,</span> Type meanlog<span class="op">,</span> Type sdlog<span class="op">){</span></span>
<span id="cb19-5"><a href="testing.html#cb19-5" tabindex="-1"></a>  Type resid <span class="op">=</span> <span class="op">(</span>log<span class="op">(</span>x<span class="op">)-</span>meanlog<span class="op">)/</span>sdlog<span class="op">;</span></span>
<span id="cb19-6"><a href="testing.html#cb19-6" tabindex="-1"></a>  Type logres <span class="op">=</span> <span class="op">-</span>log<span class="op">(</span>sqrt<span class="op">(</span><span class="dv">2</span><span class="op">*</span>M_PI<span class="op">))</span> <span class="op">-</span> log<span class="op">(</span>sdlog<span class="op">)</span> <span class="op">-</span> Type<span class="op">(</span><span class="fl">0.5</span><span class="op">)*</span>resid<span class="op">*</span>resid <span class="op">-</span> log<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb19-7"><a href="testing.html#cb19-7" tabindex="-1"></a>  <span class="cf">return</span> logres<span class="op">;</span></span>
<span id="cb19-8"><a href="testing.html#cb19-8" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Then, create <code>dlognorm-unit.cpp</code> in <code>tests/gtest</code> that has a test suite for the <code>dlognorm</code> function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb20-1"><a href="testing.html#cb20-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;gtest/gtest.h&quot;</span></span>
<span id="cb20-2"><a href="testing.html#cb20-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;../../src/dlognorm.hpp&quot;</span></span>
<span id="cb20-3"><a href="testing.html#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="testing.html#cb20-4" tabindex="-1"></a><span class="co">// # R code that generates true values for the test</span></span>
<span id="cb20-5"><a href="testing.html#cb20-5" tabindex="-1"></a><span class="co">// dlnorm(1.0, 0.0, 1.0, TRUE) = -0.9189385</span></span>
<span id="cb20-6"><a href="testing.html#cb20-6" tabindex="-1"></a><span class="co">// dlnorm(5.0, 10.0, 2.5, TRUE) = -9.07679</span></span>
<span id="cb20-7"><a href="testing.html#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="testing.html#cb20-8" tabindex="-1"></a>namespace <span class="op">{</span></span>
<span id="cb20-9"><a href="testing.html#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="testing.html#cb20-10" tabindex="-1"></a>  <span class="co">// TestSuiteName: dlognormTest; TestName: DoubleInput and IntInput</span></span>
<span id="cb20-11"><a href="testing.html#cb20-11" tabindex="-1"></a>  <span class="co">// Test dlognorm with double input values</span></span>
<span id="cb20-12"><a href="testing.html#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="testing.html#cb20-13" tabindex="-1"></a>  TEST<span class="op">(</span>dlognormTest<span class="op">,</span> DoubleInput<span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-14"><a href="testing.html#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="testing.html#cb20-15" tabindex="-1"></a>    EXPECT_NEAR<span class="op">(</span> dlognorm<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span> <span class="fl">0.0</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">,</span> <span class="op">-</span><span class="fl">0.9189385</span> <span class="op">,</span> <span class="fl">0.0001</span> <span class="op">);</span></span>
<span id="cb20-16"><a href="testing.html#cb20-16" tabindex="-1"></a>    EXPECT_NEAR<span class="op">(</span> dlognorm<span class="op">(</span><span class="fl">5.0</span><span class="op">,</span> <span class="fl">10.0</span><span class="op">,</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">,</span> <span class="op">-</span><span class="fl">9.07679</span> <span class="op">,</span> <span class="fl">0.0001</span> <span class="op">);</span></span>
<span id="cb20-17"><a href="testing.html#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="testing.html#cb20-18" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb20-19"><a href="testing.html#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="testing.html#cb20-20" tabindex="-1"></a>  <span class="co">// Test dlognorm with integer input values</span></span>
<span id="cb20-21"><a href="testing.html#cb20-21" tabindex="-1"></a></span>
<span id="cb20-22"><a href="testing.html#cb20-22" tabindex="-1"></a>  TEST<span class="op">(</span>dlognormTest<span class="op">,</span> IntInput<span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-23"><a href="testing.html#cb20-23" tabindex="-1"></a></span>
<span id="cb20-24"><a href="testing.html#cb20-24" tabindex="-1"></a>    EXPECT_NEAR<span class="op">(</span> dlognorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">,</span> <span class="op">-</span><span class="fl">0.9189385</span> <span class="op">,</span> <span class="fl">0.0001</span> <span class="op">);</span></span>
<span id="cb20-25"><a href="testing.html#cb20-25" tabindex="-1"></a></span>
<span id="cb20-26"><a href="testing.html#cb20-26" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb20-27"><a href="testing.html#cb20-27" tabindex="-1"></a></span>
<span id="cb20-28"><a href="testing.html#cb20-28" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><code>EXPECT_NEAR(val1, val2, absolute_error)</code> verifies that the difference between <code>val1</code> and <code>val2</code> does not exceed the absolute error bound <code>absolute_error</code>. <code>EXPECT_NE(val1, val2)</code> verifies that <code>val1</code> is not equal to <code>val2</code>. See GoogleTest <a href="https://google.github.io/googletest/reference/assertions.html">assertions reference</a> for more <code>EXPECT_</code> macros.</p>
<p>Finally, the test must be added to <code>tests/gtest/CMakeLists.txt</code> before running the tests. Add the following contents to the end of <code>tests/gtest/CMakeLists.txt</code> to enable testing in CMake, declare the C++ test
binary you want to build (dlognorm_test), and link it to GoogleTest (gtest_main). :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb21-1"><a href="testing.html#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="testing.html#cb21-2" tabindex="-1"></a><span class="kw">add_executable</span>(<span class="bn">dlognorm_test</span></span>
<span id="cb21-3"><a href="testing.html#cb21-3" tabindex="-1"></a>  dlognorm-unit.cpp</span>
<span id="cb21-4"><a href="testing.html#cb21-4" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="testing.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="testing.html#cb21-6" tabindex="-1"></a><span class="kw">target_include_directories</span>(<span class="bn">dlognorm_test</span></span>
<span id="cb21-7"><a href="testing.html#cb21-7" tabindex="-1"></a>  <span class="ot">PUBLIC</span></span>
<span id="cb21-8"><a href="testing.html#cb21-8" tabindex="-1"></a>    <span class="dv">${CMAKE_SOURCE_DIR}</span>/../</span>
<span id="cb21-9"><a href="testing.html#cb21-9" tabindex="-1"></a>)</span>
<span id="cb21-10"><a href="testing.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="testing.html#cb21-11" tabindex="-1"></a><span class="kw">target_link_libraries</span>(<span class="bn">dlognorm_test</span></span>
<span id="cb21-12"><a href="testing.html#cb21-12" tabindex="-1"></a>  gtest_main</span>
<span id="cb21-13"><a href="testing.html#cb21-13" tabindex="-1"></a>)</span>
<span id="cb21-14"><a href="testing.html#cb21-14" tabindex="-1"></a></span>
<span id="cb21-15"><a href="testing.html#cb21-15" tabindex="-1"></a><span class="kw">include</span>(<span class="im">GoogleTest</span>)</span>
<span id="cb21-16"><a href="testing.html#cb21-16" tabindex="-1"></a><span class="fu">gtest_discover_tests</span>(<span class="bn">dlognorm_test</span>)</span></code></pre></div>
<p>Now you can build and run your test using the <a href="testing.html#build-and-run-the-tests">instructions in Build and run the tests</a>. The output when running <code>ctest</code> will look something like the following, note that there is a failing test:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="testing.html#cb22-1" tabindex="-1"></a><span class="ex">Internal</span> ctest changing into directory: C:/Users/Kathryn.Doering/Documents/testing/FIMS/build</span>
<span id="cb22-2"><a href="testing.html#cb22-2" tabindex="-1"></a><span class="ex">Test</span> project C:/Users/Kathryn.Doering/Documents/testing/FIMS/build</span>
<span id="cb22-3"><a href="testing.html#cb22-3" tabindex="-1"></a>    <span class="ex">Start</span> 1: dlognorm.use_double_inputs</span>
<span id="cb22-4"><a href="testing.html#cb22-4" tabindex="-1"></a><span class="ex">1/7</span> Test <span class="co">#1: dlognorm.use_double_inputs .......   Passed    0.04 sec</span></span>
<span id="cb22-5"><a href="testing.html#cb22-5" tabindex="-1"></a>    <span class="ex">Start</span> 2: dlognorm.use_int_inputs</span>
<span id="cb22-6"><a href="testing.html#cb22-6" tabindex="-1"></a><span class="ex">2/7</span> Test <span class="co">#2: dlognorm.use_int_inputs ..........   Passed    0.04 sec</span></span>
<span id="cb22-7"><a href="testing.html#cb22-7" tabindex="-1"></a>    <span class="ex">Start</span> 3: modelTest.eta</span>
<span id="cb22-8"><a href="testing.html#cb22-8" tabindex="-1"></a><span class="ex">3/7</span> Test <span class="co">#3: modelTest.eta ....................   Passed    0.04 sec</span></span>
<span id="cb22-9"><a href="testing.html#cb22-9" tabindex="-1"></a>    <span class="ex">Start</span> 4: modelTest.nll</span>
<span id="cb22-10"><a href="testing.html#cb22-10" tabindex="-1"></a><span class="ex">4/7</span> Test <span class="co">#4: modelTest.nll ....................   Passed    0.04 sec</span></span>
<span id="cb22-11"><a href="testing.html#cb22-11" tabindex="-1"></a>    <span class="ex">Start</span> 5: modelTest.evaluate</span>
<span id="cb22-12"><a href="testing.html#cb22-12" tabindex="-1"></a><span class="ex">5/7</span> Test <span class="co">#5: modelTest.evaluate ...............   Passed    0.04 sec</span></span>
<span id="cb22-13"><a href="testing.html#cb22-13" tabindex="-1"></a>    <span class="ex">Start</span> 6: dlognormTest.DoubleInput</span>
<span id="cb22-14"><a href="testing.html#cb22-14" tabindex="-1"></a><span class="ex">6/7</span> Test <span class="co">#6: dlognormTest.DoubleInput .........   Passed    0.04 sec</span></span>
<span id="cb22-15"><a href="testing.html#cb22-15" tabindex="-1"></a>    <span class="ex">Start</span> 7: dlognormTest.IntInput</span>
<span id="cb22-16"><a href="testing.html#cb22-16" tabindex="-1"></a><span class="ex">7/7</span> Test <span class="co">#7: dlognormTest.IntInput ............***Failed    0.04 sec</span></span>
<span id="cb22-17"><a href="testing.html#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="testing.html#cb22-18" tabindex="-1"></a><span class="ex">86%</span> tests passed, 1 tests failed out of 7</span>
<span id="cb22-19"><a href="testing.html#cb22-19" tabindex="-1"></a></span>
<span id="cb22-20"><a href="testing.html#cb22-20" tabindex="-1"></a><span class="ex">Total</span> Test time <span class="er">(</span><span class="ex">real</span><span class="kw">)</span> <span class="ex">=</span>   0.28 sec</span>
<span id="cb22-21"><a href="testing.html#cb22-21" tabindex="-1"></a></span>
<span id="cb22-22"><a href="testing.html#cb22-22" tabindex="-1"></a><span class="ex">The</span> following tests FAILED:</span>
<span id="cb22-23"><a href="testing.html#cb22-23" tabindex="-1"></a>          <span class="ex">7</span> <span class="at">-</span> dlognormTest.IntInput <span class="er">(</span><span class="ex">Failed</span><span class="kw">)</span></span>
<span id="cb22-24"><a href="testing.html#cb22-24" tabindex="-1"></a><span class="ex">Errors</span> while running CTest</span>
<span id="cb22-25"><a href="testing.html#cb22-25" tabindex="-1"></a><span class="ex">Output</span> from these tests are in: C:/Users/Kathryn.Doering/Documents/testing/FIMS/build/Testing/Temporary/LastTest.log</span>
<span id="cb22-26"><a href="testing.html#cb22-26" tabindex="-1"></a><span class="ex">Use</span> <span class="st">&quot;--rerun-failed --output-on-failure&quot;</span> to re-run the failed cases verbosely.</span></code></pre></div>
</div>
<div id="debugging-a-c-test" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Debugging a C++ test<a href="testing.html#debugging-a-c-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two ways to debug a C++ test, interactively using <code>gdb</code> or via print statements.</p>
<p>To debug C++ code (e.g., segmentation error/memory corruption) using gdb:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="testing.html#cb23-1" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-S</span> . <span class="at">-B</span> build <span class="at">-G</span> Ninja <span class="at">-DCMAKE_BUILD_TYPE</span><span class="op">=</span>Debug</span>
<span id="cb23-2"><a href="testing.html#cb23-2" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build <span class="at">--parallel</span> 16</span>
<span id="cb23-3"><a href="testing.html#cb23-3" tabindex="-1"></a><span class="ex">ctest</span> <span class="at">--test-dir</span> build <span class="at">--parallel</span> 16</span>
<span id="cb23-4"><a href="testing.html#cb23-4" tabindex="-1"></a><span class="fu">gdb</span> ./build/tests/gtest/population_dynamics_population.exe</span>
<span id="cb23-5"><a href="testing.html#cb23-5" tabindex="-1"></a><span class="ex">c</span> // to continue without paging</span>
<span id="cb23-6"><a href="testing.html#cb23-6" tabindex="-1"></a><span class="ex">run</span> // to see which line of code is broken</span>
<span id="cb23-7"><a href="testing.html#cb23-7" tabindex="-1"></a><span class="ex">print</span> this-<span class="op">&gt;</span>log_naa // for example, print this-<span class="op">&gt;</span>log_naa to see the value of log_naa<span class="kw">;</span> </span>
<span id="cb23-8"><a href="testing.html#cb23-8" tabindex="-1"></a><span class="ex">print</span> i // for example, print i from the broken for loop</span>
<span id="cb23-9"><a href="testing.html#cb23-9" tabindex="-1"></a><span class="ex">bt</span> // backtrace</span>
<span id="cb23-10"><a href="testing.html#cb23-10" tabindex="-1"></a><span class="ex">q</span> // to quit</span></code></pre></div>
<p>To debug C++ code with print statements you must update the C++ in the desired <code>.hpp</code> file by adding <code>std::ofstream out(“file_name.txt”)</code> and using <code>out &lt;&lt; variable;</code> to print out values of the variable. The output of the print statements will be in <code>FIMS/build/tests/gtest/debug.txt</code> after you run the <code>cmake</code> and <code>ctest</code> calls the <a href="testing.html#build-and-run-the-tests">instructions in Build and run the tests</a>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb24-1"><a href="testing.html#cb24-1" tabindex="-1"></a>nfleets <span class="op">=</span> fleets<span class="op">.</span>size<span class="op">();</span></span>
<span id="cb24-2"><a href="testing.html#cb24-2" tabindex="-1"></a>std<span class="op">::</span>ofstream out<span class="op">(</span><span class="st">&quot;debug.txt&quot;</span><span class="op">);</span></span>
<span id="cb24-3"><a href="testing.html#cb24-3" tabindex="-1"></a>out <span class="op">&lt;&lt;</span>nfleets<span class="op">;</span></span></code></pre></div>
<p>More complex examples with text identifying the quantities</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb25-1"><a href="testing.html#cb25-1" tabindex="-1"></a>out <span class="op">&lt;&lt;</span><span class="st">&quot; fleet_index: &quot;</span><span class="op">&lt;&lt;</span>fleet_index<span class="op">&lt;&lt;</span><span class="st">&quot; index_yaf: &quot;</span><span class="op">&lt;&lt;</span>index_yaf<span class="op">&lt;&lt;</span><span class="st">&quot; index_yf: &quot;</span><span class="op">&lt;&lt;</span>index_yf<span class="op">&lt;&lt;</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb25-2"><a href="testing.html#cb25-2" tabindex="-1"></a>out <span class="op">&lt;&lt;</span><span class="st">&quot; population.Fmort[index_yf]: &quot;</span><span class="op">&lt;&lt;</span>population<span class="op">.</span>Fmort<span class="op">[</span>index_yf<span class="op">]&lt;&lt;</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span></code></pre></div>
</div>
<div id="benchmark-example" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Benchmark example<a href="testing.html#benchmark-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://github.com/google/benchmark">Google Benchmark</a> measures the real time and CPU time used for running the produced binary. We will continue using the dlognorm.hpp example. Create <code>dlognorm_benchmark.cpp</code> in <code>tests/gtest</code> with the following code to run the <code>dlognorm</code> function and use BENCHMARK to see how long it takes.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb26-1"><a href="testing.html#cb26-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;benchmark/benchmark.h&quot;</span></span>
<span id="cb26-2"><a href="testing.html#cb26-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;../../src/dlognorm.hpp&quot;</span></span>
<span id="cb26-3"><a href="testing.html#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="testing.html#cb26-4" tabindex="-1"></a><span class="dt">void</span> BM_dlgnorm<span class="op">(</span>benchmark<span class="op">::</span>State<span class="op">&amp;</span> state<span class="op">)</span></span>
<span id="cb26-5"><a href="testing.html#cb26-5" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb26-6"><a href="testing.html#cb26-6" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> _ <span class="op">:</span> state<span class="op">)</span></span>
<span id="cb26-7"><a href="testing.html#cb26-7" tabindex="-1"></a>    dlognorm<span class="op">(</span><span class="fl">5.0</span><span class="op">,</span> <span class="fl">10.0</span><span class="op">,</span> <span class="fl">2.5</span><span class="op">);</span></span>
<span id="cb26-8"><a href="testing.html#cb26-8" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb26-9"><a href="testing.html#cb26-9" tabindex="-1"></a>BENCHMARK<span class="op">(</span>BM_dlgnorm<span class="op">);</span></span></code></pre></div>
<p>Next, the following needs to be added to the end of <code>tests/gtest/CMakeLists.txt</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb27-1"><a href="testing.html#cb27-1" tabindex="-1"></a><span class="fu">FetchContent_Declare</span>(</span>
<span id="cb27-2"><a href="testing.html#cb27-2" tabindex="-1"></a>  googlebenchmark</span>
<span id="cb27-3"><a href="testing.html#cb27-3" tabindex="-1"></a>  <span class="ot">URL</span> https://github.com/google/benchmark/archive/refs/tags/v1.<span class="dt">6.0</span>.zip</span>
<span id="cb27-4"><a href="testing.html#cb27-4" tabindex="-1"></a>)</span>
<span id="cb27-5"><a href="testing.html#cb27-5" tabindex="-1"></a><span class="fu">FetchContent_MakeAvailable</span>(googlebenchmark)</span>
<span id="cb27-6"><a href="testing.html#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="testing.html#cb27-7" tabindex="-1"></a><span class="kw">add_executable</span>(<span class="bn">dlognorm_benchmark</span></span>
<span id="cb27-8"><a href="testing.html#cb27-8" tabindex="-1"></a>  dlognorm_benchmark.cpp</span>
<span id="cb27-9"><a href="testing.html#cb27-9" tabindex="-1"></a>)</span>
<span id="cb27-10"><a href="testing.html#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="testing.html#cb27-11" tabindex="-1"></a><span class="kw">target_include_directories</span>(<span class="bn">dlognorm_benchmark</span></span>
<span id="cb27-12"><a href="testing.html#cb27-12" tabindex="-1"></a>  <span class="ot">PUBLIC</span></span>
<span id="cb27-13"><a href="testing.html#cb27-13" tabindex="-1"></a>    <span class="dv">${CMAKE_SOURCE_DIR}</span>/../</span>
<span id="cb27-14"><a href="testing.html#cb27-14" tabindex="-1"></a>)</span>
<span id="cb27-15"><a href="testing.html#cb27-15" tabindex="-1"></a></span>
<span id="cb27-16"><a href="testing.html#cb27-16" tabindex="-1"></a><span class="kw">target_link_libraries</span>(<span class="bn">dlognorm_benchmark</span></span>
<span id="cb27-17"><a href="testing.html#cb27-17" tabindex="-1"></a>  benchmark_main</span>
<span id="cb27-18"><a href="testing.html#cb27-18" tabindex="-1"></a>)</span></code></pre></div>
<p>To run the benchmark, run cmake sending output to the build subfolder and run the created executable:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="testing.html#cb28-1" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">--build</span> build</span>
<span id="cb28-2"><a href="testing.html#cb28-2" tabindex="-1"></a><span class="ex">build/tests/gtest/dlognorm_benchmark.exe</span></span></code></pre></div>
<p>The output from <code>dlognorm_benchmark.exe</code> might look like this:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="testing.html#cb29-1" tabindex="-1"></a><span class="ex">Run</span> on <span class="er">(</span><span class="ex">8</span> X 2112 MHz CPU s<span class="kw">)</span></span>
<span id="cb29-2"><a href="testing.html#cb29-2" tabindex="-1"></a><span class="ex">CPU</span> Caches:</span>
<span id="cb29-3"><a href="testing.html#cb29-3" tabindex="-1"></a>  <span class="ex">L1</span> Data 32 KiB <span class="er">(</span><span class="ex">x4</span><span class="kw">)</span></span>
<span id="cb29-4"><a href="testing.html#cb29-4" tabindex="-1"></a><span class="ex">L1</span> Instruction 32 KiB <span class="er">(</span><span class="ex">x4</span><span class="kw">)</span></span>
<span id="cb29-5"><a href="testing.html#cb29-5" tabindex="-1"></a><span class="ex">L2</span> Unified 256 KiB <span class="er">(</span><span class="ex">x4</span><span class="kw">)</span></span>
<span id="cb29-6"><a href="testing.html#cb29-6" tabindex="-1"></a><span class="ex">L3</span> Unified 8192 KiB <span class="er">(</span><span class="ex">x1</span><span class="kw">)</span></span>
<span id="cb29-7"><a href="testing.html#cb29-7" tabindex="-1"></a><span class="ex">***WARNING***</span> Library was built as DEBUG. Timings may be affected.</span>
<span id="cb29-8"><a href="testing.html#cb29-8" tabindex="-1"></a><span class="ex">-----------------------------------------------------</span></span>
<span id="cb29-9"><a href="testing.html#cb29-9" tabindex="-1"></a>  <span class="ex">Benchmark</span>           Time             CPU   Iterations</span>
<span id="cb29-10"><a href="testing.html#cb29-10" tabindex="-1"></a><span class="ex">-----------------------------------------------------</span></span>
<span id="cb29-11"><a href="testing.html#cb29-11" tabindex="-1"></a>  <span class="ex">BM_dlgnorm</span>        153 ns          153 ns      4480000</span></code></pre></div>
</div>
<div id="clean-up-after-running-c-tests" class="section level3 hasAnchor" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Clean up after running C++ tests<a href="testing.html#clean-up-after-running-c-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After running the examples above, the build generates files (i.e., the source code, libraries, and executables) and saves the files in the <code>build</code> subfolder. The example above demonstrates an “out-of-source” build which puts generated files in a completely separate directory, so that the source tree is unchanged after running tests. Using a separate source and build tree reduces the need to delete files that differ between builds. If you still would like to delete CMake-generated files, just delete the <code>build</code> folder, and then build and run tests by repeating the commands below. The files from the <code>build</code> folder are included in the FIMS repository’s .gitignore file, so should <em>not</em> be pushed to the FIMS repository.</p>
<p>For simple C++ functions like the examples above, we do not need to clean up the tests. Clean up is only necessary in a few situations.</p>
<ul>
<li>If memory for an object was allocated during testing and not deallocated then the object needs to be deleted (e.g., <code>delete object</code>).</li>
<li>If you used a test fixture from GoogleTest to use the same data configuration for multiple tests, <code>TearDown()</code> can be used to clean up the test and then the test fixture will be deleted. See <a href="https://google.github.io/googletest/primer.html#same-data-multiple-tests">GoogleTest user’s guide</a> for more details.</li>
<li>If you do not want to keep any of the files produced by the example and want to completely clear any uncommitted changes and files from the git repo, run <code>git restore .</code>, which removes any committed changes in files tracked by git or <code>git clean -fd</code> to get remove all untracked files in the repository.</li>
</ul>
</div>
</div>
<div id="templates-for-googletest-testing" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Templates for GoogleTest testing<a href="testing.html#templates-for-googletest-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section includes templates for creating unit tests and benchmarks.
This is the code that would go into the .cpp files in tests/gtest.</p>
<div id="c-test-templates" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> C++ test templates<a href="testing.html#c-test-templates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="unit-test-template" class="section level4 hasAnchor" number="10.3.1.1">
<h4><span class="header-section-number">10.3.1.1</span> Unit test template<a href="testing.html#unit-test-template" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb30-1"><a href="testing.html#cb30-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;gtest/gtest.h&quot;</span></span>
<span id="cb30-2"><a href="testing.html#cb30-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;../../src/code.hpp&quot;</span></span>
<span id="cb30-3"><a href="testing.html#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="testing.html#cb30-4" tabindex="-1"></a><span class="co">// # R code that generates true values for the test</span></span>
<span id="cb30-5"><a href="testing.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="testing.html#cb30-6" tabindex="-1"></a>namespace <span class="op">{</span></span>
<span id="cb30-7"><a href="testing.html#cb30-7" tabindex="-1"></a></span>
<span id="cb30-8"><a href="testing.html#cb30-8" tabindex="-1"></a>  <span class="co">// Description of Test 1</span></span>
<span id="cb30-9"><a href="testing.html#cb30-9" tabindex="-1"></a>  TEST<span class="op">(</span>TestSuiteName<span class="op">,</span> Test1Name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-10"><a href="testing.html#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="testing.html#cb30-11" tabindex="-1"></a>    <span class="op">...</span> test body <span class="op">...</span></span>
<span id="cb30-12"><a href="testing.html#cb30-12" tabindex="-1"></a></span>
<span id="cb30-13"><a href="testing.html#cb30-13" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb30-14"><a href="testing.html#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="testing.html#cb30-15" tabindex="-1"></a>  <span class="co">// Description of Test 2</span></span>
<span id="cb30-16"><a href="testing.html#cb30-16" tabindex="-1"></a>  TEST<span class="op">(</span>TestSuiteName<span class="op">,</span> Test2Name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-17"><a href="testing.html#cb30-17" tabindex="-1"></a></span>
<span id="cb30-18"><a href="testing.html#cb30-18" tabindex="-1"></a>    <span class="op">...</span> test body <span class="op">...</span></span>
<span id="cb30-19"><a href="testing.html#cb30-19" tabindex="-1"></a></span>
<span id="cb30-20"><a href="testing.html#cb30-20" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb30-21"><a href="testing.html#cb30-21" tabindex="-1"></a></span>
<span id="cb30-22"><a href="testing.html#cb30-22" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="benchmark-template" class="section level4 hasAnchor" number="10.3.1.2">
<h4><span class="header-section-number">10.3.1.2</span> Benchmark template<a href="testing.html#benchmark-template" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb31-1"><a href="testing.html#cb31-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;benchmark/benchmark.h&quot;</span></span>
<span id="cb31-2"><a href="testing.html#cb31-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;../../src/code.hpp&quot;</span></span>
<span id="cb31-3"><a href="testing.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="testing.html#cb31-4" tabindex="-1"></a><span class="dt">void</span> BM_FunctionName<span class="op">(</span>benchmark<span class="op">::</span>State<span class="op">&amp;</span> state<span class="op">)</span></span>
<span id="cb31-5"><a href="testing.html#cb31-5" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb31-6"><a href="testing.html#cb31-6" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> _ <span class="op">:</span> state<span class="op">)</span></span>
<span id="cb31-7"><a href="testing.html#cb31-7" tabindex="-1"></a>    <span class="co">// This code gets timed</span></span>
<span id="cb31-8"><a href="testing.html#cb31-8" tabindex="-1"></a>    Function<span class="op">()</span></span>
<span id="cb31-9"><a href="testing.html#cb31-9" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-10"><a href="testing.html#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="testing.html#cb31-11" tabindex="-1"></a><span class="co">// Register the function as a benchmark</span></span>
<span id="cb31-12"><a href="testing.html#cb31-12" tabindex="-1"></a>BENCHMARK<span class="op">(</span>BM_FunctionName<span class="op">);</span></span></code></pre></div>
</div>
<div id="testsgtestcmakelists.txt-template" class="section level4 hasAnchor" number="10.3.1.3">
<h4><span class="header-section-number">10.3.1.3</span> <code>tests/gtest/CMakeLists.txt</code> template<a href="testing.html#testsgtestcmakelists.txt-template" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>These lines are added each time a new test, e.g., <code>TestSuiteName1</code>, is added:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb32-1"><a href="testing.html#cb32-1" tabindex="-1"></a><span class="co">// Add test suite 1</span></span>
<span id="cb32-2"><a href="testing.html#cb32-2" tabindex="-1"></a>add_executable<span class="op">(</span>TestSuiteName1</span>
<span id="cb32-3"><a href="testing.html#cb32-3" tabindex="-1"></a>  test1<span class="op">.</span>cpp</span>
<span id="cb32-4"><a href="testing.html#cb32-4" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb32-5"><a href="testing.html#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="testing.html#cb32-6" tabindex="-1"></a>target_link_libraries<span class="op">(</span>TestSuiteName1</span>
<span id="cb32-7"><a href="testing.html#cb32-7" tabindex="-1"></a>  gtest_main</span>
<span id="cb32-8"><a href="testing.html#cb32-8" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb32-9"><a href="testing.html#cb32-9" tabindex="-1"></a></span>
<span id="cb32-10"><a href="testing.html#cb32-10" tabindex="-1"></a>gtest_discover_tests<span class="op">(</span>TestSuiteName1<span class="op">)</span></span></code></pre></div>
<p>These lines are added each time a new benchmark, e.g., <code>benchmark1</code>, is added:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb33-1"><a href="testing.html#cb33-1" tabindex="-1"></a><span class="co">// Add benchmark 1</span></span>
<span id="cb33-2"><a href="testing.html#cb33-2" tabindex="-1"></a>add_executable<span class="op">(</span>benchmark1</span>
<span id="cb33-3"><a href="testing.html#cb33-3" tabindex="-1"></a>  benchmark1<span class="op">.</span>cpp</span>
<span id="cb33-4"><a href="testing.html#cb33-4" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb33-5"><a href="testing.html#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="testing.html#cb33-6" tabindex="-1"></a>target_link_libraries<span class="op">(</span>benchmark1</span>
<span id="cb33-7"><a href="testing.html#cb33-7" tabindex="-1"></a>  benchmark_main</span>
<span id="cb33-8"><a href="testing.html#cb33-8" tabindex="-1"></a><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="r-testing" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> R testing<a href="testing.html#r-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R tests are written using {testthat}, which can be <a href="https://testthat.r-lib.org/">installed as an R package</a>. More details on {testthat} can be found in the <a href="https://r-pkgs.org/tests.html">testing chapter of R packages</a>.</p>
<div id="testing-fims-locally" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Testing FIMS locally<a href="testing.html#testing-fims-locally" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test FIMS R functions, interactively and locally, use <code>devtools::install()</code> rather than <code>devtools::load_all()</code> because using <code>load_all()</code> will turn on the debugger, bloating the .o file and may lead to a compilation error, among other problems (see <a href="developer-software-and-installation-guide.html#installing-fims">Installing FIMS</a> for more information).</p>
</div>
<div id="testing-using-gdbsource" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Testing using <code>gdbsource</code><a href="testing.html#testing-using-gdbsource" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can interactively debug C++ code using <code>TMB::gdbsource()</code> in RStudio.</p>
</div>
<div id="and-file-organization" class="section level3 hasAnchor" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> and file organization<a href="testing.html#and-file-organization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Group functions and their helpers together, i.e., the “main function plus helpers” approach.</li>
<li>{testthat} tests that are a test of Rcpp code should be called <code>test-rcpp-[description].R</code>.</li>
<li>Integration tests that do not have a corresponding <code>.R</code> file should use the follwing convention: <code>test-integration-[description].R</code>.</li>
</ul>
</div>
<div id="r-template" class="section level3 hasAnchor" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> R template<a href="testing.html#r-template" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Naming conventions for {testthat} files follow the <a href="https://style.tidyverse.org/tests.html">tidyverse test convention</a> as well as the using <code>test-rcpp-[description].R</code> for tests of Rcpp code and <code>test-integration-[description].R</code> for integration tests without a corresponding R function.</p>
<p>The format for an individual testthat test is is:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="testing.html#cb34-1" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">&quot;TestName&quot;</span>, {</span>
<span id="cb34-2"><a href="testing.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="testing.html#cb34-3" tabindex="-1"></a>  ...test body...</span>
<span id="cb34-4"><a href="testing.html#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="testing.html#cb34-5" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="random-numbers" class="section level3 hasAnchor" number="10.4.5">
<h3><span class="header-section-number">10.4.5</span> Random numbers<a href="testing.html#random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulation results might be dependent on the order of calls, leading to failed tests just because different random numbers are used or the order of the simulation changes through model
development (see <a href="https://github.com/NOAA-FIMS/FIMS-planning/issues/25">FIMS-planning discussion 25</a> for details). Below are some potential soluations.
- Add a TRUE/FALSE parameter in each FIMS simulation module for
setting up testing seed. When testing the module, set the parameter to
TRUE to fix the seed number in R and conduct tests. If adding a TRUE/FALSE parameter does not work as expected, then carefully check simulated data from each component and make sure it is not a model coding error.
- Use <code>set.seed()</code> from R to set the seed and investigate using {rstream} to generate multiple streams of random numbers to associate distinct streams of random numbers with different sources of randomness. {rstream} was specifically designed to address the issue of needing very long streams of pseudo-random numbers for parallel computations. See <a href="https://www.iro.umontreal.ca/~lecuyer/myftp/papers/rstream.pdf">the rstream paper</a> and <a href="http://www-labs.iro.umontreal.ca/~lecuyer/myftp/streams00/">RngStreams</a> for more details.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="documentation-template.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": null,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/noaa-fims/collaborative_workflow/edit/main/10-testing.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/noaa-fims/collaborative_workflow/blob/main/10-testing.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
